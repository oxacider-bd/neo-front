<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neo | Cyber Tech AI</title>
    <style>
        /* CSS: The Matrix Terminal Look */
        * { box-sizing: border-box; }
        body {
            background-color: #050505;
            color: #00FF41;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        .terminal {
            width: 95%;
            max-width: 900px;
            height: 85vh;
            background: rgba(0, 0, 0, 0.95);
            border: 1px solid #00FF41;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .terminal-header {
            background: #1a1a1a;
            padding: 10px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #333;
        }

        .buttons { display: flex; gap: 8px; }
        .dot { height: 12px; width: 12px; border-radius: 50%; }
        .red { background: #ff5f56; }
        .yellow { background: #ffbd2e; }
        .green { background: #27c93f; }
        .title { margin-left: 20px; color: #888; font-size: 13px; letter-spacing: 1px; }

        #chat-window {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            scroll-behavior: smooth;
        }

        .msg { margin-bottom: 15px; line-height: 1.5; white-space: pre-wrap; }
        .user-prefix { color: #fff; font-weight: bold; }
        .neo-prefix { color: #00FF41; font-weight: bold; }
        .loading { font-style: italic; opacity: 0.7; }

        .input-line {
            padding: 15px 20px;
            border-top: 1px solid #1a1a1a;
            display: flex;
            align-items: center;
        }

        .prompt { color: #00FF41; margin-right: 10px; font-weight: bold; }
        
        input {
            background: transparent;
            border: none;
            color: #00FF41;
            font-family: inherit;
            font-size: 16px;
            outline: none;
            flex: 1;
        }

        /* Custom Scrollbar */
        #chat-window::-webkit-scrollbar { width: 6px; }
        #chat-window::-webkit-scrollbar-thumb { background: #004411; border-radius: 10px; }
    </style>
</head>
<body>

    <div class="terminal">
        <div class="terminal-header">
            <div class="buttons">
                <div class="dot red"></div>
                <div class="dot yellow"></div>
                <div class="dot green"></div>
            </div>
            <div class="title">NEO@KALI: ~ (STU_SESSION_ACTIVE)</div>
        </div>
        
        <div id="chat-window">
            <div class="msg">
                <span class="neo-prefix">Neo:</span> Initializing secure connection... Done.
                Welcome, Student. Ask me anything about CyberSecurity, Linux, or Tech.
            </div>
        </div>

        <div class="input-line">
            <span class="prompt">guest@neo:~$</span>
            <input type="text" id="cmd-input" placeholder="Type your query..." autocomplete="off" autofocus>
        </div>
    </div>

    <script>
        // JS: Interaction Logic
        const chatWindow = document.getElementById('chat-window');
        const cmdInput = document.getElementById('cmd-input');

        // তোমার Render URL এখানে বসাবে
        const BACKEND_URL = "https://neo-py-98bv.onrender.com";

        cmdInput.addEventListener('keypress', async (e) => {
            if (e.key === 'Enter' && cmdInput.value.trim() !== "") {
                const userText = cmdInput.value.trim();
                
                // ১. ইউজারের মেসেজ স্ক্রিনে দেখানো
                printMsg('user', `guest@neo:~$ ${userText}`);
                cmdInput.value = "";

                // ২. লোডিং দেখানো
                const loadingId = printMsg('neo', "Neo is decrypting your request...", true);

                try {
                    // ৩. ব্যাকএন্ডে রিকোয়েস্ট পাঠানো
                    const response = await fetch(BACKEND_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            prompt: userText,
                            session_id: "user_session_001" // চাইলে ডায়নামিক করতে পারো
                        })
                    });

                    const data = await response.json();
                    
                    // ৪. রেসপন্স স্ক্রিনে আপডেট করা
                    updateLoadingMsg(loadingId, `Neo: ${data.neo}`);

                } catch (error) {
                    updateLoadingMsg(loadingId, "Error: Connection lost to the matrix.");
                    console.error(error);
                }
            }
        });

        function printMsg(role, text, isLoading = false) {
            const div = document.createElement('div');
            const id = 'msg-' + Date.now();
            div.id = id;
            div.className = `msg ${role === 'user' ? 'user-prefix' : 'neo-prefix'} ${isLoading ? 'loading' : ''}`;
            div.innerText = text;
            chatWindow.appendChild(div);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            return id;
        }

        function updateLoadingMsg(id, newText) {
            const el = document.getElementById(id);
            if (el) {
                el.innerText = newText;
                el.classList.remove('loading');
                chatWindow.scrollTop = chatWindow.scrollHeight;
            }
        }
    </script>
</body>
</html>